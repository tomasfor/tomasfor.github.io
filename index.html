<!DOCTYPE html>

<html>
<head>
  <meta http-equiv="CONTENT-TYPE" content="text/html; charset=UTF-8">
  <link rel="stylesheet" href="styles/style.css"/>
  <script src="js.js"></script>
  <title>Hello, World!</title>
  <script>
  
  var active_player = 0;
  var tidValue = 0;
  var playerValue = 0;
  
  const color_array =[
  "#b1c9f0",
  "#5785cf",
  "#fab6d3",
  "#a4d457",
  "#d63152",
  "#ffffff",
  "#ffde7a",
  "#ffa85c",
  "#aa56db",
  "#FFFFFF"
  ]
  var style_pause_width = 0;
  var style_pause_height = 0;
  var style_div_width =0;
  var style_div_height =0;
  var style_div_main_width =0;
  var style_div_main_height =0;
  
  var style_time_container_width = 0;
  var style_time_container_main_width = 0;
  
  var style_time_container_height = 0;
  var style_time_container_main_height = 0;
  
  var style_time_container_font = 0;
  var style_time_container_main_font = 0;
  
  
  function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }
 
  
  function height_calc(type) {
    if (playerValue == 2 )
      {
        style_pause_width = "50%";
        style_pause_height ="40%";
        style_div_width ="50%";
        style_div_main_width ="100%";
        style_div_height ="40%";
        style_div_main_height ="60%";
        style_player_font = "100%";
        style_player_main_font = "250%";
        style_time_container_width = "70%";
        style_time_container_main_width = "70%";
        style_time_container_height = "25%";
        style_time_container_main_height = "35%";
        style_time_container_font = "150%";
        style_time_container_main_font = "350%";
      }
      else if(playerValue ==4)
      {
        
        style_pause_width = "50%";
        style_pause_height ="25%";
        style_div_width ="50%";
        style_div_height ="25%";
        style_div_main_width ="100%";
        style_div_main_height ="50%";
        style_player_font = "100%";
        style_player_main_font = "250%";
        style_time_container_width = "70%";
        style_time_container_main_width = "70%";
        style_time_container_height = "35%";
        style_time_container_main_height = "35%";
        style_time_container_font = "150%";
        style_time_container_main_font = "350%";
        
      }
      else if(playerValue == 6 )
      {
        
        style_pause_width = "50%";
        style_pause_height ="20%";													
        style_div_width ="50%";	
        style_div_height ="20%";
        style_div_main_width ="100%";
        style_div_main_height ="40%";
        style_player_font = "100%";
        style_player_main_font = "250%";
        style_time_container_width = "60%";
        style_time_container_main_width = "70%";
        style_time_container_height = "40%";
        style_time_container_main_height = "40%";
        style_time_container_font = "150%";
        style_time_container_main_font = "350%";
        
      }
      else if(playerValue == 8 )
      {
        
        style_pause_width = "50%";
        style_pause_height ="12.5%";
        style_div_width ="50%";
        style_div_height ="12.5%";
        style_div_main_width ="100%";
        style_div_main_height ="50%";
        style_player_font = "100%";
        style_player_main_font = "250%";
        style_time_container_width = "60%";
        style_time_container_main_width = "70%";
        style_time_container_height = "40%";
        style_time_container_main_height = "40%";
        style_time_container_font = "150%";
        style_time_container_main_font = "350%";
        
      }
      else if(playerValue ==3)
      {
        
        style_pause_width = "100%";
        style_pause_height ="10%";
        style_div_width ="50%";
        style_div_height ="40%";
        style_div_main_width ="100%";
        style_div_main_height ="50%";
        style_player_font = "120%";
        style_player_main_font = "250%";
        style_time_container_width = "70%";
        style_time_container_main_width = "70%";
        style_time_container_height = "25%";
        style_time_container_main_height = "40%";
        style_time_container_font = "200%";
        style_time_container_main_font = "350%";
        
      }
      else if(playerValue ==5)
      {
        
        style_pause_width = "100%";
        style_pause_height ="10%";
        style_div_width ="50%";
        style_div_height ="20%";
        style_div_main_width ="100%";
        style_div_main_height ="50%";
        style_player_font = "100%";
        style_player_main_font = "250%";
        style_time_container_width = "60%";
        style_time_container_main_width = "80%";
        style_time_container_height = "40%";
        style_time_container_main_height = "40%";
        style_time_container_font = "150%";
        style_time_container_main_font = "500%";
        
      }
      else if(playerValue ==7)
      {
        
        style_pause_width = "100%";
        style_pause_height ="9%";
        style_div_width ="50%";
        style_div_height ="17%";
        style_div_main_width ="100%";
        style_div_main_height ="40%";
        style_player_font = "100%";
        style_player_main_font = "250%";
        style_time_container_width = "60%";
        style_time_container_main_width = "70%";
        style_time_container_height = "40%";
        style_time_container_main_height = "40%";
        style_time_container_font = "150%";
        style_time_container_main_font = "350%";
        
      }
      else if(playerValue ==9)
      {
        
        style_pause_width = "100%";
        style_pause_height ="8%";
        style_div_width ="50%";
        style_div_height ="13%";
        style_div_main_width ="100%";
        style_div_main_height ="40%";
        style_player_font = "100%";
        style_player_main_font = "250%";
        style_time_container_width = "60%";
        style_time_container_main_width = "70%";
        style_time_container_height = "40%";
        style_time_container_main_height = "40%";
        style_time_container_font = "150%";
        style_time_container_main_font = "350%";
        
      }
    
    return 0;
  }
  
  
  function hex_to_int(hex)
  {
    if (hex == 'F')
    {
      return 15;
    }
    else if (hex == 'E')
    {
      return 14;
    }
    else if (hex == 'D')
    {
      return 13;
    }
    else if (hex == 'C')
    {
      return 12;
    }
    else if (hex == 'B')
    {
      return 11;
    }
    else if (hex == 'A')
    {
      return 10;
    }
    
    return hex;
  }
  
  
  function textColor(backgroundColor)
  {
    
    let tmp = hex_to_int(backgroundColor.substring(1,2))*16;
    tmp -= -hex_to_int(backgroundColor.substring(2,3));
    tmp -= -hex_to_int(backgroundColor.substring(3,4))*16;
    tmp -= -hex_to_int(backgroundColor.substring(4,5));
    tmp -= -hex_to_int(backgroundColor.substring(5,6))*16;
    tmp -= -hex_to_int(backgroundColor.substring(6,7));

    if( tmp < 765/2)
    {
      return "#FFFFFF";
    }
    else
    {
      return "#000000";
    }
  }
  
  function styleOption(old_arg, new_arg)
  {
    const element = document.getElementById("game_container");  
    for (let i = 0 ; i< element.childNodes.length;i++)
    {
      
      if (element.childNodes[i].id.substring(0,6).localeCompare("player")==0)
      {
        element.childNodes[i].style.order -= 1;
        element.childNodes[i].style.width =style_div_width;         
        element.childNodes[i].style.height =style_div_height;
        element.childNodes[i].childNodes[0].style.fontSize = style_player_font;
        element.childNodes[i].childNodes[1].style.height = style_time_container_height;
        element.childNodes[i].childNodes[1].style.width = style_time_container_width;
        element.childNodes[i].childNodes[1].style.fontSize = style_time_container_font;
      }
      else
      {
        element.childNodes[i].style.width = style_pause_width;
        element.childNodes[i].style.height = style_pause_height;
      }
    }
    element.childNodes[old_arg].style.order=playerValue;
    element.childNodes[new_arg].style.width=style_div_main_width;
    element.childNodes[new_arg].style.height=style_div_main_height;
    element.childNodes[new_arg].childNodes[0].style.fontSize = style_player_main_font;
    element.childNodes[new_arg].childNodes[1].style.height = style_time_container_main_height;
    element.childNodes[new_arg].childNodes[1].style.width = style_time_container_main_width;
    element.childNodes[new_arg].childNodes[1].style.fontSize = style_time_container_main_font;
    
  }
  
  function update_player()
  {
    styleOption(active_player-1,( active_player % playerValue));
    active_player = ( active_player % playerValue) + 1;
    
  }
  function get_time(elem, elem2)
  {
    let time =0; 
    
    let minutes_first = elem.innerText.substring(0,1);
    let minutes_second= elem.innerText.substring(1,2);
    let seconds_first = elem2.innerText.substring(0,1);
    let seconds_second= elem2.innerText.substring(1,2);
    
    time -= -seconds_first*10;
    time -= -seconds_second;
    time -= -minutes_first*60*10;
    time -= -minutes_second *60;
    
    return time
  }
  
  function set_time(elem,elem2,time)
  {
    let seconds = time%60;
    let minutes = Math.floor(time/60);
    if (seconds < 10) {
      seconds = "0"+seconds
    }
    if (minutes < 10)
    {
        minutes = "0"+minutes
    }
    elem.innerText = `${minutes}`;
    elem2.innerText = `${seconds}`;
  }
  
  async function demo() 
  {
    for (let i = 0; i < 1000000; i++) 
    {
      
      await sleep(1000);
      const element = document.getElementById("game_container");
      
      if(active_player > 0)
      {
        let old_time = get_time(element.childNodes[active_player-1].childNodes[1].childNodes[0], element.childNodes[active_player-1].childNodes[1].childNodes[2])
        
        if (old_time >0)
        {
          let new_time = old_time - 1;
          set_time(element.childNodes[active_player-1].childNodes[1].childNodes[0], element.childNodes[active_player-1].childNodes[1].childNodes[2],new_time);
          
        }
      }
      
    }
  }
  
  
  function updateStage (stage)
  {
    if( stage==1) 
    {
      document.getElementById("start_up_container_part_1").style.display = "block";
      document.getElementById("start_up_container_part_2").style.display = "none";
      document.getElementById("start_up_container_part_3").style.display = "none";
      document.getElementById("start_up_container_part_4").style.display = "none";
      document.getElementById("game_container").style.display = "none";
      
    }
    else if(stage ==2)
    {
      document.getElementById("start_up_container_part_1").style.display = "none";
      document.getElementById("start_up_container_part_2").style.display = "block";
      document.getElementById("start_up_container_part_3").style.display = "none";
      document.getElementById("start_up_container_part_4").style.display = "none";
      document.getElementById("game_container").style.display = "none";
      
    }
    else if(stage ==3)
    {
      document.getElementById("start_up_container_part_1").style.display = "none";
      document.getElementById("start_up_container_part_2").style.display = "none";
      document.getElementById("start_up_container_part_3").style.display = "block";
      document.getElementById("start_up_container_part_4").style.display = "none";
      document.getElementById("game_container").style.display = "none";
      
    }
    else if(stage ==4)
    {
      document.getElementById("start_up_container_part_1").style.display = "none";
      document.getElementById("start_up_container_part_2").style.display = "none";
      document.getElementById("start_up_container_part_3").style.display = "none";
      document.getElementById("start_up_container_part_4").style.display = "block";
      document.getElementById("game_container").style.display = "none";
      
    }
    else if (stage == 5)
    {  
      document.getElementById("start_up_container_part_1").style.display = "none";
      document.getElementById("start_up_container_part_2").style.display = "none";
      document.getElementById("start_up_container_part_3").style.display = "none";
      document.getElementById("start_up_container_part_4").style.display = "none";
      document.getElementById("game_container").style.display = "flex";
      
    }
  }
  

  
  function swap_player (form) {
  
    const element = document.getElementById("game_container");
 
    if(active_player > 0)
    {
      let old_time = get_time(element.childNodes[active_player-1].childNodes[1].childNodes[0],element.childNodes[active_player-1].childNodes[1].childNodes[2]);
     
      if (old_time >0)
      {
        let new_time = old_time - (-incrementValue);
        if(new_time > (99*(60)+59))
        {
          new_time = 99*(60) + 59;
          
        }
        set_time(element.childNodes[active_player-1].childNodes[1].childNodes[0],element.childNodes[active_player-1].childNodes[1].childNodes[2],  new_time) 
      }
      
      update_player();
    }
  }
  
  
  
  
  
  function getOption()
  {
    height_calc();
    
    const element = document.getElementById("game_container");  
    element.childNodes[0].remove();
    
    for (let i =0 ; i < playerValue ; i++)
    {
      const para_player = document.createElement("span");
      para_player.innerText = document.getElementById("player_"+i+"_name").value;
      para_player.style.backgroundColor = "#ffffff";
      para_player.style.boxShadow ="0px 3px 10px rgba(0,0,0,3)";
      para_player.style.borderRadius = "2px";
      para_player.style.padding = "5px";
      para_player.style.width = "50%";
      para_player.style.height = "20%";
      para_player.style.display ="flex";
      para_player.style.justifyContent = "center";
      para_player.style.alignItems ="center";
      para_player.style.fontWeight ="900";
      const para_tid_colon = document.createElement("span");
      para_tid_colon.innerText = ":";
      
      
      const para_tid_min = document.createElement("div");
      const para_tid_sec = document.createElement("div");
      para_tid_min.style.display ="flex";
      para_tid_min.style.justifyContent = "center";
      para_tid_min.style.alignItems = "center";
      para_tid_min.style.fontFamily = "Open sans, sans-serif";
      para_tid_min.style.height = "100%";
      para_tid_min.style.width = "45%";
      para_tid_min.style.fontWeight = "700";
      para_tid_min.style.backgroundColor ="#ffffff"
      para_tid_min.style.color = "#202020"
      para_tid_min.style.boxShadow ="0px 5px 10px rgba(0,0,0,3)";
      para_tid_min.style.letterSpacing = "3px";
      para_tid_min.style.borderRadius = "5px";
      
      para_tid_sec.style.display ="flex";
      para_tid_sec.style.justifyContent = "center";
      para_tid_sec.style.alignItems = "center";
      para_tid_sec.style.fontFamily = "Open sans, sans-serif";
      para_tid_sec.style.height = "100%";
      para_tid_sec.style.width = "45%";
      para_tid_sec.style.fontWeight = "700"
      para_tid_sec.style.backgroundColor ="#ffffff"
      para_tid_sec.style.color = "#202020"
      para_tid_sec.style.boxShadow ="0px 5px 10px rgba(0,0,0,3)";
      para_tid_sec.style.letterSpacing = "3px";
      para_tid_sec.style.borderRadius = "5px";
      
      set_time(para_tid_min,para_tid_sec, tidValue);
      
      const para_tid_container = document.createElement("div");
      
      para_tid_container.appendChild(para_tid_min);
      para_tid_container.appendChild(para_tid_colon);
      para_tid_container.appendChild(para_tid_sec);
      para_tid_container.style.display = "flex";
      para_tid_container.style.justifyContent = "space-between";
      para_tid_container.style.alignItems = "center";
      
      
      
      
      const para_container = document.createElement("div");
      para_container.setAttribute("id","player_"+i+ "_container");
      para_container.setAttribute("class", "player");
      para_container.style.backgroundColor = document.getElementById("player_"+i+"_color").value;
      para_container.style.color = textColor(document.getElementById("player_"+i+"_color").value);
      para_container.appendChild(para_player);
      para_container.style.display = "flex";
      para_container.style.flexDirection = "column";
      para_container.style.justifyContent = "space-evenly";
      para_container.style.borderRadius = "10px";
      para_container.appendChild(para_tid_container);
      para_container.addEventListener("click", function (e) {
      e.preventDefault();
      swap_player();
      })
      para_container.style.order = i;
      para_container.style.display ="flex";
      
      element.appendChild(para_container);
      
     
    } 
      
    
    const para_span = document.createElement("span");
    para_span.innerText = "Start";
    
    const para_reset = document.createElement("span");
    para_reset.innerText = "Reset";
      
    const para_form = document.createElement("div");
    para_form.setAttribute("id","pause_button");
    para_form.appendChild(para_span);
    
    para_form.style.height = style_pause_height;
    para_form.style.width = style_pause_width;
    para_form.style.color = "#FFFFFF"
    element.appendChild(para_form);
      
    para_form.childNodes[0].addEventListener("click", function (e) {
    e.preventDefault();
    pause_play(e.target);
    })
    para_form.style.order = playerValue;
    styleOption(playerValue-1,0);
      
    
    demo();
      
    updateStage(5);
  }
  
  
  function createOption()
  {
    const form = document.getElementById("option_form");
    
    for (let i = 0; i< playerValue; i++)
    {
      const para_input_name = document.createElement("input");
      para_input_name.setAttribute('id',"player_"+i+"_name");
      para_input_name.setAttribute('value', "Kämpe "+(i- -1))
      para_input_name.setAttribute('class',"player_name");
      
      const para_input_color = document.createElement("input");
      para_input_color.setAttribute('id',"player_"+i+"_color");
      para_input_color.setAttribute('class',"player_color");
      para_input_color.setAttribute('type',"color");
      para_input_color.setAttribute('value', color_array[i]);
      
      const para_option_container = document.createElement("div");
      para_option_container.setAttribute('class',"player_option_container");
      
      para_option_container.appendChild(para_input_name);
      para_option_container.appendChild(para_input_color);
      
      form.appendChild(para_option_container);
    }
      
    const para_button = document.createElement("button");
    para_button.setAttribute("class","start_up_button");
    const node_button = document.createTextNode("Done!");
    const para_br = document.createElement("br");
    para_button.appendChild(node_button);
    form.appendChild(para_button);
    form.appendChild(para_br);
  }
  
  
  function getData_part_1(form)
  {
    
    playerValue = document.getElementById("scroll_count_part_1").value;
    updateStage(2);
  }
  
  function getData_part_2(form)
  {
    tidValue = document.getElementById("scroll_min_part_2").value*60;
    tidValue -= -document.getElementById("scroll_sec_part_2").value;
    updateStage(3);
  }
  
  function getData_part_3(form) 
  {
    
    incrementValue = document.getElementById("scroll_count_part_3").value;
    
    updateStage(4);
    
    createOption()
  }

  let old_active_player = 0
  
  function pause_play()
  {
    if (active_player>0)
    {
      old_active_player = active_player;
      active_player = 0; 
       
      document.getElementById("game_container").childNodes[playerValue].childNodes[0].innerText = "Continue";
      
      
    }
    else 
    {
      if(old_active_player >0)
      {
        active_player = old_active_player;
        old_active_player = 0;
        document.getElementById("game_container").childNodes[playerValue].childNodes[0].innerText = "Pause";
        
      }
      else
      {
        active_player = 1;
        document.getElementById("game_container").childNodes[playerValue].childNodes[0].innerText = "Pause";
        
      }
    }
    
  }
  
  
  
  </script>
</head>
<body>
  
  
  <div id = "start_up_container_part_1" class="start_up_container">
    <div class="intro">Välkommen att till ett <br>nytt spel!</div>   
    <div id="label_container_part_1" class="label_container">
      <div id="label_part_1"class="start_up_label">Antal spelare:</div>    
      <div id= "scroll_container_part_1" class="scroll_container">
        <div id= "scroll_count_part_1" class="scroll_count"></div> 
      </div>
    </div>
    <div id="button_part_1" class="start_up_button">Next</div>   
  </div>
  
  
  <div id = "start_up_container_part_2"class="start_up_container">
     <div class="intro">Länge ska vi spela?</div>   
     <div id="label_container_part_1" class="label_container">
       <div id="label_part_2"class="start_up_label">Tid per spelare:</div>
      <div id= "scroll_container_part_2" class="scroll_container">
        <div id= "scroll_min_part_2" class="scroll_min"></div>
        <div id= "scroll_colon_part_2"class="scroll_colon"></div>
        <div id= "scroll_sec_part_2" class="scroll_sec"></div>
      </div>
    </div>
    <div id="button_part_2" class="start_up_button">Next</div>
  </div>
  
  <div id = "start_up_container_part_3" class="start_up_container">
    <div class="intro">Är det någon som tänker länge?</div>
    <div id="label_container_part_3" class="label_container">
      <div id="label_part_3" class="start_up_label">Inkrement:</div>
      <div id= "scroll_container_part_3" class="scroll_container">
        <div id= "scroll_count_part_3" class="scroll_count"></div>
      </div>
    </div>
    <div id = "button_part_3" class="start_up_button">Play!</div>
  </div>
  
  
  

  
  <div id = "start_up_container_part_4" class="start_up_container">
    <div class="intro">Lite namn, Lite färg <br> Sen kör vi!</div>

    <form id="option_form">
    </form>
  </div>
  
  <div id="game_container">
  </div>
  
  
  <script>
  create_scroll(document.getElementById("scroll_count_part_1"),2,9,2);
  document.getElementById("button_part_1").addEventListener("click", function (e)
  {
  e.preventDefault();
  getData_part_1(e.target);
  
  }); 
  
  create_scroll(document.getElementById("scroll_min_part_2"),0,99,0);
  
  w = document.getElementById("scroll_colon_part_2");
  
  w.innerText =":";
  w.style.fontSize = "50px";
   
  create_scroll(document.getElementById("scroll_sec_part_2"),0,59,30);

  document.getElementById("button_part_2").addEventListener("click", function (e) 
  {
  e.preventDefault();
  getData_part_2(e.target);
  });
  
  document.getElementById("button_part_3").addEventListener("click", function (e) 
  {
  e.preventDefault();
  getData_part_3(e.target);
  });
  create_scroll(document.getElementById("scroll_count_part_3"),0,120,5);

  updateStage(1);
  
  document.getElementById("option_form").addEventListener("submit", function (e)
  {
  e.preventDefault();
  getOption(e.target);
  });
    
  
  </script>
  
  <style >
  .scroll_container {
    display: flex;
    align-items: center;
    justify-content: center;
  
    width:25%;
  }
  #scroll_container_part_2{
    width:40%;
  }

  .scroll_min, .scroll_sec, .scroll_count{
    
    overflow-y:auto;
    
    display: flex;
    align-items:center;
    flex-flow:column nowrap;
  }
  


  
  body {
    
    padding:0px;
    margin:0px;
    background-color:#e8f0dd;
    
    
    
    
  }
  .start_up_container{
    margin:20% 0%;
    
  }

  .start_up_label {
    display:flex;
    justify-content:center;
    align-item:center;
    width:40%;
    margin:7% 0px;
    font-size:125%;
  }
  .label_container {
    display:flex;
    justify-content:center;
    
  }

  
  .start_up_button {
    background-color:#b1c0c0;
    display:flex;
    justify-content:center;
    align-item:center;
    margin:15px 40%;
    padding:6px 0px;
    width:20%;
    border-radius:4px; 
    box-shadow:0px 1px 2px rgba(0,0,0,3);
    border: 1px solid gray;
  }

  .intro {
    background-color:pink;
    display:flex;
    justify-content:center;
    align-item:center;
    margin:15px 10%;
    padding:6px 0px;
    width:80%;
    font-size:125%;
    font-weight:500;
    text-align:center;
    border-radius:4px;
  }
  #game_container {
    display:flex;
    flex-wrap:wrap;
    height:100vh;
    margin:0;
    padding:0;
  }

  .player {
    align-items:center;
    justify-content: center;
    
  }
  
  #pause_button {
    flex:0,0,50px;
    display:flex;
    justify-content:center;
    align-items: center;
    margin:0px;
    height:10%;
    width:100%;
  }
  #pause_button span{
    display:flex;
    border:1px solid #202020;
    background-color:#a7aba8;
    margin: 0 50%;
    padding: 10px 10%;
    justify-content:center;
    align-items: center;
    border-radius:3px;
    
  }
  .player_option_container {
    
    display:flex;
    justify-content:center;
    align-itemns:center;
    margin:5px;
    height:25px;
  }
  .player_name {
    width:100px;
    margin:0px 10px;
    background-color: #e8e8e8;
    border:1px solid #e0e0e0;
    border-radius:3px;
    
  }
  .player_color {
    background-color:transparent;
    border:none;
    width: calc(23px + 12px);
    height:calc(23px + 12px);
    margin:-5px;
    }
  .player_colojr::-webkit-color-swatch{
    border:none;
    border-radius:3px;
  }
  
  </style>
  
  
</body>
</html>
